{% extends 'portal/base.html' %}

{% block title %}{{ event.title }}{% endblock %}

{% block content %}
    <!-- =============================================================== -->
    <!--                      EVENT DETAILS DISPLAY                      -->
    <!-- =============================================================== -->

    <!-- Hero Section -->
    <section class="text-center py-20 px-6 relative overflow-hidden">
        <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-links/10 rounded-full blur-3xl animate-pulse"></div>
        <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl animate-pulse delay-1000"></div>
        <div class="relative z-10">
            <h1 class="text-4xl sm:text-6xl md:text-7xl font-black mb-4 tracking-tight">
                {{ event.title }}
            </h1>
            <p class="max-w-3xl mx-auto text-base sm:text-lg md:text-xl text-light-text-secondary dark:text-dark-text-secondary mb-8">
                {{ event.hero_section_details }}
            </p>
            <div id="cta-buttons">
                 <a href="{{ event.registration_link }}" target="_blank" rel="noopener noreferrer" class="bg-accent hover:opacity-90 text-dark-bg font-bold py-3 px-8 rounded-lg text-lg transition-transform hover:scale-105 transform inline-block">
                    Register Now &rarr;
                </a>
            </div>
        </div>
    </section>

    <!-- Countdown Timer Section -->
    <section id="countdown-section" class="py-12 sm:py-16">
        <!-- This section remains the same, with the dynamic countdown timer -->
        <div class="container mx-auto px-6 text-center">
            <h2 id="countdown-title" class="text-2xl font-bold mb-10 uppercase tracking-[0.4em]"></h2>
            <div id="countdown-container" class="flex justify-center items-start flex-wrap gap-3 sm:gap-4 md:gap-8">
                <div class="flex flex-col items-center"><div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative"><svg class="countdown-svg" viewBox="0 0 150 150"></svg><div id="days" class="countdown-number">00</div></div><div class="countdown-label">Days</div></div>
                <div class="flex flex-col items-center"><div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative"><svg class="countdown-svg" viewBox="0 0 150 150"></svg><div id="hours" class="countdown-number">00</div></div><div class="countdown-label">Hours</div></div>
                <div class="flex flex-col items-center"><div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative"><svg class="countdown-svg" viewBox="0 0 150 150"></svg><div id="minutes" class="countdown-number">00</div></div><div class="countdown-label">Minutes</div></div>
                <div class="flex flex-col items-center"><div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative"><svg class="countdown-svg" viewBox="0 0 150 150"></svg><div id="seconds" class="countdown-number">00</div></div><div class="countdown-label">Seconds</div></div>
            </div>
            <div id="countdown-ended-message" class="hidden mt-8 text-3xl font-bold text-accent"></div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-16 sm:py-20">
        <!-- This section remains the same, displaying event.about_event etc. -->
        <div class="container mx-auto px-6 grid md:grid-cols-2 gap-12 items-center">
            <div>
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">About The Event</h2>
                <p class="text-light-text-secondary dark:text-dark-text-secondary whitespace-pre-line">{{ event.about_event }}</p>
            </div>
             <div>
                <h3 class="text-2xl font-bold mb-4">Why Participate?</h3>
                <p class="text-light-text-secondary dark:text-dark-text-secondary whitespace-pre-line">{{ event.benefits }}</p>
            </div>
        </div>
    </section>

    <!-- Schedule Section -->
    <section id="schedule" class="py-16 sm:py-20">
         <!-- This section remains the same, looping through event.schedules.all -->
        <div class="container mx-auto px-6">
            <div class="text-center mb-12"><h2 class="text-3xl sm:text-4xl font-bold">Event Schedule</h2></div>
            <div class="max-w-4xl mx-auto space-y-8">
                {% for day in event.schedules.all %}
                <div class="card p-6 md:p-8 border border-gray-200 dark:border-gray-800">
                    <h3 class="font-bold text-xl md:text-2xl mb-4">Day {{ day.day_number }} <span class="text-light-text-secondary dark:text-dark-text-secondary font-medium">- {{ day.date|date:"F j, Y" }}</span></h3>
                    <div class="space-y-4">
                        {% for item in day.sub_schedules.all %}
                        <div class="flex items-center border-t border-gray-200 dark:border-gray-800 pt-4">
                            <p class="w-1/3 md:w-1/4 font-semibold text-links text-sm md:text-base">{{ item.time_start|time:"g:i A" }} - {{ item.time_end|time:"g:i A" }}</p>
                            <p class="w-2/3 md:w-3/4">{{ item.activity_description }}</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="py-16 sm:py-20">
        <!-- This section remains the same, looping through event.faqs.all -->
        <div class="container mx-auto px-6 max-w-3xl">
            <div class="text-center mb-12"><h2 class="text-3xl sm:text-4xl font-bold">Frequently Asked Questions</h2></div>
            <div class="space-y-4">
                {% for faq in event.faqs.all %}
                <details class="card p-6 cursor-pointer group border border-gray-200 dark:border-gray-800">
                    <summary class="flex justify-between items-center font-semibold text-lg">{{ faq.question }}<span class="text-accent group-open:rotate-45 transition-transform text-2xl font-light">+</span></summary>
                    <p class="mt-4 text-light-text-secondary dark:text-dark-text-secondary">{{ faq.answer }}</p>
                </details>
                {% endfor %}
            </div>
        </div>
    </section>
{% endblock %}


{% block scripts %}
<style>
    /* These styles are specific to the detail page's countdown */
    .countdown-number{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-weight:700;@apply text-2xl sm:text-3xl md:text-4xl text-light-text dark:text-dark-text}.countdown-label{text-transform:uppercase;letter-spacing:.2em;margin-top:10px;@apply text-xs sm:text-sm text-light-text-secondary dark:text-dark-text-secondary}.countdown-svg{position:absolute;top:0;left:0;width:100%;height:100%;transform:rotate(-90deg)}.countdown-circle{transition:stroke-dashoffset .3s linear;stroke-width:8;fill:transparent}
</style>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const registrationEndDate = new Date("{{ event.registration_end.isoformat }}");
    const eventStartDate = new Date("{{ event.event_start.isoformat }}");

    // The rest of your countdown timer JavaScript remains exactly the same
    // It will automatically use the dates from the database event for this specific page
    const countdownTitleEl=document.getElementById('countdown-title'),countdownContainerEl=document.getElementById('countdown-container'),countdownEndedEl=document.getElementById('countdown-ended-message'),ctaButtonsEl=document.getElementById('cta-buttons'),daysEl=document.getElementById('days'),hoursEl=document.getElementById('hours'),minutesEl=document.getElementById('minutes'),secondsEl=document.getElementById('seconds');let countdownInterval;const startCountdown=(e,t)=>{countdownInterval&&clearInterval(countdownInterval),countdownTitleEl.textContent=t,countdownContainerEl.classList.remove('hidden'),countdownEndedEl.classList.add('hidden');const n=countdownContainerEl.querySelectorAll('.countdown-item');n.forEach(e=>{const t=e.querySelector('svg');t.innerHTML='';const n=document.createElementNS("http://www.w3.org/2000/svg",'circle');n.setAttribute('class','countdown-circle'),n.setAttribute('stroke',document.documentElement.classList.contains('dark')?'#374151':'#E5E7EB'),n.setAttribute('cx',75),n.setAttribute('cy',75),n.setAttribute('r',65),t.appendChild(n);const d=document.createElementNS("http://www.w3.org/2000/svg",'circle');d.setAttribute('class','countdown-circle'),d.setAttribute('stroke','#00FF85'),d.setAttribute('cx',75),d.setAttribute('cy',75),d.setAttribute('r',65),d.style.strokeDasharray=2*Math.PI*65,t.appendChild(d)});const d=()=>{n.forEach(e=>{const t=e.querySelector('svg circle:first-child');t&&t.setAttribute('stroke',document.documentElement.classList.contains('dark')?'#374151':'#E5E7EB')})};document.addEventListener('themeChanged',d),d();const o=()=>{const n=e-new Date().getTime();if(n<0)return clearInterval(countdownInterval),void checkState();const l=Math.floor(n/864e5),r=Math.floor(n%864e5/36e5),i=Math.floor(n%36e5/6e4),s=Math.floor(n%6e4/1e3),c=e=>String(e).padStart(2,'0');daysEl.textContent=c(l),hoursEl.textContent=c(r),minutesEl.textContent=c(i),secondsEl.textContent=c(s);const a=(e,t,n)=>{const d=e.parentElement.querySelector('svg circle:last-child');d&&(d.style.strokeDashoffset=2*Math.PI*65*(1-t/n))};a(daysEl,l,30),a(hoursEl,r,24),a(minutesEl,i,60),a(secondsEl,s,60)};countdownInterval=setInterval(o,1e3),o()},checkState=()=>{const e=new Date;e<registrationEndDate?startCountdown(registrationEndDate,"Registration Ends In"):e<eventStartDate?(startCountdown(eventStartDate,"Event Starts In"),ctaButtonsEl&&ctaButtonsEl.classList.add('hidden')):(countdownContainerEl.classList.add('hidden'),countdownEndedEl.textContent="The Event Has Started!",countdownEndedEl.classList.remove('hidden'),countdownTitleEl.textContent="Welcome, Innovators!",ctaButtonsEl&&ctaButtonsEl.classList.add('hidden'))};checkState()
});
</script>
{% endblock %}
