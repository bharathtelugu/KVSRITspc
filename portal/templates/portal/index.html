{% extends 'portal/base.html' %}

{% block content %}
<!-- Hero Section -->
<section class="text-center py-20 px-6 relative overflow-hidden">
    <!-- Background Glows -->
    <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-links/10 rounded-full blur-3xl animate-pulse"></div>
    <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl animate-pulse delay-1000"></div>
    <div class="relative z-10">
        <h1 class="text-4xl sm:text-6xl md:text-7xl font-black mb-4 tracking-tight">
            Build the Future with <span class="text-accent">Generative AI</span>
        </h1>
        <p class="max-w-3xl mx-auto text-base sm:text-lg md:text-xl text-light-text-secondary dark:text-dark-text-secondary mb-8">
            Join the brightest minds to solve real-world problems using cutting-edge AI. Compete, learn, and innovate.
        </p>
        <div id="cta-buttons">
            {% if user.is_authenticated %}
                 <a href="#" class="bg-accent hover:opacity-90 text-dark-bg font-bold py-3 px-8 rounded-lg text-lg transition-transform hover:scale-105 transform inline-block">
                    Go to Dashboard &rarr;
                </a>
            {% else %}
                 <a href="https://forms.gle/Fi4qMKEZzViipHNF9" target="_blank" rel="noopener noreferrer" class="bg-accent hover:opacity-90 text-dark-bg font-bold py-3 px-8 rounded-lg text-lg transition-transform hover:scale-105 transform inline-block">
                    Register Now &rarr;
                </a>
            {% endif %}
        </div>
    </div>
</section>

<!-- Countdown Timer Section -->
<section id="countdown-section" class="py-12 sm:py-16">
    <div class="container mx-auto px-6 text-center">
        <h2 id="countdown-title" class="text-2xl font-bold mb-10 uppercase tracking-[0.4em]"></h2>
        <div id="countdown-container" class="flex justify-center items-start flex-wrap gap-3 sm:gap-4 md:gap-8">
            <!-- Countdown Items will be generated by JS -->
            <div class="flex flex-col items-center">
                <div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative">
                    <svg class="countdown-svg" viewBox="0 0 150 150"></svg>
                    <div id="days" class="countdown-number">00</div>
                </div>
                <div class="countdown-label">Days</div>
            </div>
            <div class="flex flex-col items-center">
                <div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative">
                    <svg class="countdown-svg" viewBox="0 0 150 150"></svg>
                    <div id="hours" class="countdown-number">00</div>
                </div>
                <div class="countdown-label">Hours</div>
            </div>
            <div class="flex flex-col items-center">
                <div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative">
                    <svg class="countdown-svg" viewBox="0 0 150 150"></svg>
                    <div id="minutes" class="countdown-number">00</div>
                </div>
                <div class="countdown-label">Minutes</div>
            </div>
            <div class="flex flex-col items-center">
                <div class="countdown-item w-24 h-24 sm:w-32 sm:h-32 md:w-36 md:h-36 relative">
                    <svg class="countdown-svg" viewBox="0 0 150 150"></svg>
                    <div id="seconds" class="countdown-number">00</div>
                </div>
                <div class="countdown-label">Seconds</div>
            </div>
        </div>
        <div id="countdown-ended-message" class="hidden mt-8 text-3xl font-bold text-accent"></div>
    </div>
</section>

<!-- About Section -->
<section id="about" class="py-16 sm:py-20">
    <div class="container mx-auto px-6">
        <div class="text-center mb-12">
            <h2 class="text-3xl sm:text-4xl font-bold">Why Join The AI Hackathon?</h2>
            <p class="text-light-text-secondary dark:text-dark-text-secondary mt-2">Level up your skills and build something amazing.</p>
        </div>
        <div class="grid md:grid-cols-3 gap-8">
            <!-- Feature Card 1 -->
            <div class="card p-8 rounded-2xl text-center flex flex-col items-center border border-gray-200 dark:border-gray-800">
                <div class="w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center mb-4"><i data-feather="cpu" class="w-8 h-8 text-accent"></i></div>
                <h3 class="text-xl font-bold mb-2">Hands-On AI Experience</h3>
                <p class="text-light-text-secondary dark:text-dark-text-secondary">Go beyond theory and get practical experience with cutting-edge generative AI models.</p>
            </div>
            <!-- Feature Card 2 -->
            <div class="card p-8 rounded-2xl text-center flex flex-col items-center border border-gray-200 dark:border-gray-800">
                <div class="w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center mb-4"><i data-feather="gift" class="w-8 h-8 text-accent"></i></div>
                <h3 class="text-xl font-bold mb-2">Win Awesome Prizes</h3>
                <p class="text-light-text-secondary dark:text-dark-text-secondary">Compete for exclusive merchandise, certificates, and recognition as a top innovator.</p>
            </div>
            <!-- Feature Card 3 -->
            <div class="card p-8 rounded-2xl text-center flex flex-col items-center border border-gray-200 dark:border-gray-800">
                <div class="w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center mb-4"><i data-feather="users" class="w-8 h-8 text-accent"></i></div>
                <h3 class="text-xl font-bold mb-2">Network & Collaborate</h3>
                <p class="text-light-text-secondary dark:text-dark-text-secondary">Connect with fellow tech enthusiasts, form teams, and learn from your peers in a fun environment.</p>
            </div>
        </div>
    </div>
</section>

<style>
    .countdown-number {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-weight: 700;
        @apply text-2xl sm:text-3xl md:text-4xl text-light-text dark:text-dark-text;
    }
    .countdown-label {
        text-transform: uppercase;
        letter-spacing: 0.2em;
        margin-top: 10px;
        @apply text-xs sm:text-sm text-light-text-secondary dark:text-dark-text-secondary;
    }
    .countdown-svg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        transform: rotate(-90deg);
    }
    .countdown-circle {
        transition: stroke-dashoffset 0.3s linear;
        stroke-width: 8;
        fill: transparent;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- Countdown Timer Logic ---
    const registrationEndDate = new Date();
    registrationEndDate.setHours(23, 59, 59, 999); // End of today
    
    const eventStartDate = new Date("September 25, 2025 09:30:00");

    const countdownTitleEl = document.getElementById('countdown-title');
    const countdownContainerEl = document.getElementById('countdown-container');
    const countdownEndedEl = document.getElementById('countdown-ended-message');
    const ctaButtonsEl = document.getElementById('cta-buttons');
    
    const daysEl = document.getElementById('days');
    const hoursEl = document.getElementById('hours');
    const minutesEl = document.getElementById('minutes');
    const secondsEl = document.getElementById('seconds');

    let countdownInterval;

    const startCountdown = (targetDate, title, endMessage) => {
        if (countdownInterval) clearInterval(countdownInterval);

        countdownTitleEl.textContent = title;
        countdownContainerEl.classList.remove('hidden');
        countdownEndedEl.classList.add('hidden');

        // Setup SVG Circles
        const countdownItems = countdownContainerEl.querySelectorAll('.countdown-item');
        countdownItems.forEach(item => {
            const svg = item.querySelector('svg');
            svg.innerHTML = ''; // Clear previous circles
            const radius = 65;
            const circumference = 2 * Math.PI * radius;
            
            // Background Circle
            const bgCircle = document.createElementNS("http://www.w3.org/2000/svg", 'circle');
            bgCircle.setAttribute('class', 'countdown-circle');
            bgCircle.setAttribute('stroke', document.documentElement.classList.contains('dark') ? '#374151' : '#E5E7EB');
            bgCircle.setAttribute('cx', 75);
            bgCircle.setAttribute('cy', 75);
            bgCircle.setAttribute('r', radius);
            svg.appendChild(bgCircle);

            // Progress Circle
            const progressCircle = document.createElementNS("http://www.w3.org/2000/svg", 'circle');
            progressCircle.setAttribute('class', 'countdown-circle');
            progressCircle.setAttribute('stroke', '#00FF85');
            progressCircle.setAttribute('cx', 75);
            progressCircle.setAttribute('cy', 75);
            progressCircle.setAttribute('r', radius);
            progressCircle.style.strokeDasharray = circumference;
            svg.appendChild(progressCircle);
        });
        
        const updateThemeColors = () => {
             countdownItems.forEach(item => {
                const bgCircle = item.querySelector('svg circle:first-child');
                 if(bgCircle) {
                    bgCircle.setAttribute('stroke', document.documentElement.classList.contains('dark') ? '#374151' : '#E5E7EB');
                 }
            });
        };
        document.addEventListener('themeChanged', updateThemeColors);
        updateThemeColors();


        const update = () => {
            const now = new Date().getTime();
            const difference = targetDate - now;

            if (difference < 0) {
                clearInterval(countdownInterval);
                checkState(); // Move to the next state
                return;
            }

            const d = Math.floor(difference / (1000 * 60 * 60 * 24));
            const h = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const m = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((difference % (1000 * 60)) / 1000);
            
            const format = (num) => (num < 10 ? "0" + num : num);
            daysEl.textContent = format(d);
            hoursEl.textContent = format(h);
            minutesEl.textContent = format(m);
            secondsEl.textContent = format(s);

            const updateCircle = (el, value, max) => {
                const progressCircle = el.parentElement.querySelector('svg circle:last-child');
                if (progressCircle) {
                    const radius = 65;
                    const circumference = 2 * Math.PI * radius;
                    const offset = circumference - (value / max) * circumference;
                    progressCircle.style.strokeDashoffset = offset;
                }
            };
            
            updateCircle(daysEl, d, 30); // Assuming max 30 days out for visual
            updateCircle(hoursEl, h, 24);
            updateCircle(minutesEl, m, 60);
            updateCircle(secondsEl, s, 60);
        };

        countdownInterval = setInterval(update, 1000);
        update();
    };

    const checkState = () => {
        const now = new Date();
        if (now < registrationEndDate) {
            startCountdown(registrationEndDate, "Registration Ends In");
        } else if (now < eventStartDate) {
            startCountdown(eventStartDate, "Event Starts In");
            if (ctaButtonsEl) ctaButtonsEl.classList.add('hidden'); // Hide registration buttons
        } else {
            countdownContainerEl.classList.add('hidden');
            countdownEndedEl.textContent = "The Event Has Started!";
            countdownEndedEl.classList.remove('hidden');
            countdownTitleEl.textContent = "Welcome, Innovators!";
            if (ctaButtonsEl) ctaButtonsEl.classList.add('hidden');
        }
    };

    checkState();
});
</script>
{% endblock %}

